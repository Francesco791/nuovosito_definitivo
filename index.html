<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Immobili in Ticino - Trova la tua casa ideale</title>
  <meta name="description" content="Scopri le migliori offerte immobiliari nel Canton Ticino. Case, ville e appartamenti in vendita e affitto.">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700&family=Nunito:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      font-family: 'Nunito', sans-serif;
      margin: 0;
      padding: 0;
      background-color: #fefefe;
      color: #2d2d2d;
      line-height: 1.6;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    h1 {
      font-family: 'Playfair Display', serif;
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 10px;
      color: #6E5C4F;
    }

    .subtitle {
      font-size: 1.1rem;
      color: #777;
      margin-bottom: 30px;
    }

    /* Filtri */
    .filters {
      background: white;
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      margin-bottom: 30px;
      border: 1px solid #e5e7eb;
    }

    .filters-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      align-items: end;
    }

    .filter-group {
      display: flex;
      flex-direction: column;
    }

    .filter-group label {
      font-weight: 600;
      margin-bottom: 8px;
      color: #333;
      font-size: 14px;
    }

    .filter-group select,
    .filter-group input {
      padding: 12px;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      font-family: 'Nunito', sans-serif;
      font-size: 14px;
      transition: border-color 0.3s ease;
    }

    .filter-group select:focus,
    .filter-group input:focus {
      outline: none;
      border-color: #6E5C4F;
    }

    .filter-actions {
      display: flex;
      gap: 10px;
    }

    .btn {
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      font-family: 'Nunito', sans-serif;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 14px;
    }

    .btn-primary {
      background-color: #6E5C4F;
      color: white;
    }

    .btn-primary:hover {
      background-color: #594b40;
      transform: translateY(-2px);
    }

    .btn-secondary {
      background-color: #f8f9fa;
      color: #6E5C4F;
      border: 2px solid #e5e7eb;
    }

    .btn-secondary:hover {
      border-color: #6E5C4F;
    }

    /* Grid immobili */
    .properties-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 25px;
      margin-top: 30px;
    }

    @media (min-width: 1200px) {
      .properties-grid {
        grid-template-columns: repeat(4, 1fr);
      }
    }

    @media (max-width: 768px) {
      .properties-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
      }
    }

    @media (max-width: 480px) {
      .properties-grid {
        grid-template-columns: 1fr;
      }
    }

    /* Card immobili */
    .property-card {
      display: flex;
      flex-direction: column;
      background: white;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      transition: all 0.3s ease;
      border: 1px solid #e5e7eb;
      height: 100%;
    }

    .property-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 8px 25px rgba(110, 92, 79, 0.2);
    }

    .property-image {
      position: relative;
      overflow: hidden;
    }

    .property-image img {
      width: 100%;
      height: 250px;
      object-fit: cover;
      transition: transform 0.3s ease;
    }

    .property-card:hover .property-image img {
      transform: scale(1.05);
    }

    .property-badge {
      position: absolute;
      top: 15px;
      left: 15px;
      background: rgba(110, 92, 79, 0.9);
      color: white;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
    }

    .property-details {
      padding: 25px;
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .property-title {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 10px;
      color: #2d2d2d;
      line-height: 1.3;
    }

    .property-location {
      font-size: 14px;
      color: #777;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .property-location::before {
      content: 'üìç';
      font-size: 12px;
    }

    .property-price {
      font-size: 20px;
      font-weight: bold;
      color: #6E5C4F;
      margin-bottom: 15px;
    }

    .property-specs {
      display: flex;
      gap: 15px;
      margin-bottom: 15px;
      font-size: 13px;
      color: #666;
      flex-wrap: wrap;
    }

    .spec-item {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .property-description {
      font-size: 14px;
      color: #555;
      margin-bottom: 20px;
      flex-grow: 1;
      line-height: 1.5;
    }

    .property-features {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 20px;
    }

    .feature-tag {
      background: #f0f9ff;
      color: #0369a1;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 500;
    }

    .property-buttons {
      display: flex;
      gap: 12px;
      margin-top: auto;
    }

    .view-button {
      flex: 1;
      padding: 12px 16px;
      background: linear-gradient(135deg, #6E5C4F 0%, #8B7355 100%);
      color: white;
      text-decoration: none;
      font-weight: 600;
      border-radius: 10px;
      transition: all 0.3s ease;
      text-align: center;
      font-size: 14px;
    }

    .view-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(110, 92, 79, 0.3);
    }

    .contact-button {
      padding: 12px 16px;
      background: white;
      color: #6E5C4F;
      border: 2px solid #6E5C4F;
      text-decoration: none;
      font-weight: 600;
      border-radius: 10px;
      transition: all 0.3s ease;
      text-align: center;
      font-size: 14px;
    }

    .contact-button:hover {
      background: #6E5C4F;
      color: white;
    }

    /* Stati di caricamento */
    .loading {
      text-align: center;
      padding: 60px 20px;
      color: #6E5C4F;
      font-size: 18px;
    }

    .no-results {
      text-align: center;
      padding: 60px 20px;
      color: #666;
      font-size: 18px;
      grid-column: 1 / -1;
    }

    .no-results-icon {
      font-size: 48px;
      margin-bottom: 20px;
    }

    /* Statistiche */
    .stats {
      display: flex;
      justify-content: center;
      gap: 30px;
      margin-bottom: 20px;
      font-size: 14px;
      color: #666;
    }

    .stat-item {
      text-align: center;
    }

    .stat-number {
      font-size: 24px;
      font-weight: bold;
      color: #6E5C4F;
      display: block;
    }

    /* Responsive filters */
    @media (max-width: 768px) {
      .filters-grid {
        grid-template-columns: 1fr;
        gap: 15px;
      }

      .filter-actions {
        justify-content: stretch;
      }

      .btn {
        flex: 1;
      }

      .property-buttons {
        flex-direction: column;
        gap: 8px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>Immobili in Ticino</h1>
      <p class="subtitle">Trova la casa dei tuoi sogni nel Canton Ticino</p>
    </div>

    <!-- Filtri -->
    <div class="filters">
      <div class="filters-grid">
        <div class="filter-group">
          <label for="location">Localit√†</label>
          <select id="location">
            <option value="">Tutte le localit√†</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label for="contract">Contratto</label>
          <select id="contract">
            <option value="">Tutti</option>
            <option value="vendita">Vendita</option>
            <option value="affitto">Affitto</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label for="type">Tipologia</label>
          <select id="type">
            <option value="">Tutti</option>
            <option value="casa">Casa/Villa</option>
            <option value="appartamento">Appartamento</option>
            <option value="commerciale">Commerciale</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label for="priceMax">Prezzo max (CHF)</label>
          <input type="number" id="priceMax" placeholder="Es. 1000000">
        </div>
        
        <div class="filter-group">
          <label for="rooms">Vani min</label>
          <select id="rooms">
            <option value="">Qualsiasi</option>
            <option value="1">1+</option>
            <option value="2">2+</option>
            <option value="3">3+</option>
            <option value="4">4+</option>
            <option value="5">5+</option>
          </select>
        </div>
        
        <div class="filter-actions">
          <button class="btn btn-primary" onclick="applyFilters()">üîç Cerca</button>
          <button class="btn btn-secondary" onclick="resetFilters()">‚Üª Reset</button>
        </div>
      </div>
    </div>

    <!-- Statistiche -->
    <div class="stats" id="stats" style="display: none;">
      <div class="stat-item">
        <span class="stat-number" id="totalCount">0</span>
        <span>Immobili totali</span>
      </div>
      <div class="stat-item">
        <span class="stat-number" id="visibleCount">0</span>
        <span>Risultati filtrati</span>
      </div>
    </div>

    <!-- Grid immobili -->
    <div class="loading" id="loading">
      Caricamento immobili in corso...
    </div>

    <div class="properties-grid" id="propertiesGrid" style="display: none;">
      <!-- Le card degli immobili verranno inserite qui via JavaScript -->
    </div>

    <div class="no-results" id="noResults" style="display: none;">
      <div class="no-results-icon">üè†</div>
      <div style="font-size: 20px; margin-bottom: 10px; color: #6E5C4F; font-weight: 600;">
        Nessun immobile trovato
      </div>
      <div>Prova a modificare i filtri di ricerca</div>
    </div>
  </div>

  <script>
    // Dati immobili generati dal build script
    const IMMOBILI_DATA = [
  {
    "id": 1,
    "titolo": "Moderna casa unifamiliare con portico",
    "comune": "Bosco Luganese",
    "regione": "Ticino",
    "prezzo": 1340000,
    "valuta": "CHF",
    "mq": 165,
    "vani": 3,
    "camere": 2,
    "bagni": 2,
    "contratto": "vendita",
    "categoria": "casa",
    "caratteristiche": [
      "vista",
      "giardino",
      "box"
    ],
    "foto": "https://img.miogest.com/26948/0/imm_304-20250424101315-1280-.jpeg",
    "descrizione": "Splendida villa unifamiliare con vista panoramica sulle montagne, situata in una zona tranquilla e ben servita.\r\n\r\nQuesta propriet√†, completamente ris...",
    "link": "https://annuncio.miogest.com/?annuncio=6GD5OAEwx04B46TV3lTeOj5nKScFIKeI/QjlNlfkWwc="
  },
  {
    "id": 2,
    "titolo": "Bella villa nel verde ",
    "comune": "Torricella",
    "regione": "Ticino",
    "prezzo": 1790000,
    "valuta": "CHF",
    "mq": 260,
    "vani": 5,
    "camere": 4,
    "bagni": 4,
    "contratto": "vendita",
    "categoria": "casa",
    "caratteristiche": [
      "vista",
      "giardino",
      "terrazzo",
      "box"
    ],
    "foto": "https://img.miogest.com/26948/0/imm_261-20250305131204-1280-.jpeg",
    "descrizione": "Bellissima villa nel verde adatta ad una famiglia numerosa grazie ai suoi spazi generosi e alla posizione collinare tranquilla e soleggiata.\r\n\r\nLa vil...",
    "link": "https://annuncio.miogest.com/?annuncio=4hEUv1xl7mHBxulBcTaX74rk2CSCJxol68baaSR6Pyw="
  },
  {
    "id": 3,
    "titolo": "Attico luminoso con vista aperta  ",
    "comune": "Lugano",
    "regione": "Ticino",
    "prezzo": 550000,
    "valuta": "CHF",
    "mq": 80,
    "vani": 2,
    "camere": 0,
    "bagni": 2,
    "contratto": "vendita",
    "categoria": "appartamento",
    "caratteristiche": [
      "vista",
      "attico",
      "box"
    ],
    "foto": "https://img.miogest.com/26948/0/imm_271-20250318133455-1280-.jpg",
    "descrizione": "In una tranquilla e pianeggiante zona residenziale di Lugano, a pochi passi dal lago e dal vivace centro citt√†, ben collegata con i mezzi pubblici, pr...",
    "link": "https://annuncio.miogest.com/?annuncio=+3G7DlmOP3AgpsczD8kA/aaKGmzcRT4saLoyqPM9MKQ="
  },
  {
    "id": 4,
    "titolo": "Un‚Äôoasi di charme con vista mozzafiato",
    "comune": "Riva San Vitale",
    "regione": "Ticino",
    "prezzo": 2500000,
    "valuta": "CHF",
    "mq": 500,
    "vani": 7,
    "camere": 4,
    "bagni": 4,
    "contratto": "vendita",
    "categoria": "casa",
    "caratteristiche": [
      "vista",
      "giardino",
      "box"
    ],
    "foto": "https://img.miogest.com/26948/0/imm_212-20250418151513-1280-.jpg",
    "descrizione": "In posizione dominante, con una vista spettacolare su Riva San Vitale, il lago e le montagne circostanti, questa affascinante propriet√† rappresenta un...",
    "link": "https://annuncio.miogest.com/?annuncio=v6VQbyEewCpycTSKYJ53hQVWW2+laY7QK1PA85aeRFM="
  },
  {
    "id": 5,
    "titolo": "Eleganza e Vista Panoramica: Due ville uniche",
    "comune": "Canobbio",
    "regione": "Ticino",
    "prezzo": 2890000,
    "valuta": "CHF",
    "mq": 171,
    "vani": 4,
    "camere": 3,
    "bagni": 2,
    "contratto": "vendita",
    "categoria": "casa",
    "caratteristiche": [
      "vista",
      "giardino",
      "terrazzo",
      "box"
    ],
    "foto": "https://img.miogest.com/26948/0/imm_66-20250312135406-1280-.jpg",
    "descrizione": "Nel comune di Canobbio, in una posizione residenziale privilegiata, nasceranno due ville dal design moderno e raffinato, progettate per valorizzare la...",
    "link": "https://annuncio.miogest.com/?annuncio=U1IsN+5sU3/OVS8sUOh9Wi64zzV1rs3zd3ttvPblkyY="
  },
  {
    "id": 6,
    "titolo": "Ihre perfekte Ferienoase ",
    "comune": "Caslano",
    "regione": "Ticino",
    "prezzo": 350000,
    "valuta": "CHF",
    "mq": 63,
    "vani": 2,
    "camere": 1,
    "bagni": 1,
    "contratto": "vendita",
    "categoria": "casa",
    "caratteristiche": [
      "giardino",
      "box"
    ],
    "foto": "https://img.miogest.com/26948/0/imm_281-20250415153416-1280-.jpeg",
    "descrizione": "Suchen Sie eine Ferienwohnung mit 2.5 Zimmern, die Komfort, Entspannung und eine erstklassige Lage vereint? Dann ist diese Immobilie genau das Richtig...",
    "link": "https://annuncio.miogest.com/?annuncio=F4ybDsB2BFt9A2wYvEA6XgIMdlNu09Yg1OQTAcIclds="
  },
  {
    "id": 7,
    "titolo": "Elegante attico con Vista Lago",
    "comune": "Pregassona",
    "regione": "Ticino",
    "prezzo": 1794000,
    "valuta": "CHF",
    "mq": 209,
    "vani": 4,
    "camere": 3,
    "bagni": 3,
    "contratto": "vendita",
    "categoria": "appartamento",
    "caratteristiche": [
      "vista",
      "attico",
      "terrazzo",
      "box"
    ],
    "foto": "https://img.miogest.com/26948/0/imm_280-20250416133142-1280-.jpg",
    "descrizione": "In posizione collinare sopra Lugano, proponiamo in vendita un elegante attico con vista panoramica mozzafiato sulla citt√† e sul lago. Situato in una m...",
    "link": "https://annuncio.miogest.com/?annuncio=jC+pLRFJbMX/oZ6FJisGjUYQKQEIb1JIxDlbi64okl8="
  },
  {
    "id": 8,
    "titolo": "Eleganza Contemporanea con Giardino",
    "comune": "Pregassona",
    "regione": "Ticino",
    "prezzo": 632500,
    "valuta": "CHF",
    "mq": 73,
    "vani": 2,
    "camere": 1,
    "bagni": 1,
    "contratto": "vendita",
    "categoria": "casa",
    "caratteristiche": [
      "vista",
      "giardino",
      "terrazzo",
      "box"
    ],
    "foto": "https://img.miogest.com/26948/0/imm_282-20250416121709-1280-.jpg",
    "descrizione": "In posizione collinare sopra Lugano, proponiamo in vendita uno splendido appartamento di 2,5 locali con giardino privato. Situato in una moderna resid...",
    "link": "https://annuncio.miogest.com/?annuncio=tr8YFyCBnGSkAY+4ofUqXzNDO5Tz/VFsidMjXy+dpSE="
  },
  {
    "id": 9,
    "titolo": "Elegante ufficio in villa storica ",
    "comune": "Lugano",
    "regione": "Ticino",
    "prezzo": 1000,
    "valuta": "CHF",
    "mq": 12,
    "vani": 1,
    "camere": 0,
    "bagni": 0,
    "contratto": "affitto",
    "categoria": "casa",
    "caratteristiche": [],
    "foto": "https://img.miogest.com/26948/0/imm_334-20250603153223-1280-.jpg",
    "descrizione": "A pochi passi dal centro e dal lago di Lugano, offriamo in locazione un elegante ufficio di un locale situato al piano terra di una villa storica.\r\n\r\n...",
    "link": "https://annuncio.miogest.com/?annuncio=q/8s2NSMMqRsAlJpR0fcnzFz2jDfrVCDZ5m7USK9nWQ="
  },
  {
    "id": 10,
    "titolo": "Accogliente 2.5 locali a due passi dal centro",
    "comune": "Lugano",
    "regione": "Ticino",
    "prezzo": 395000,
    "valuta": "CHF",
    "mq": 45,
    "vani": 2,
    "camere": 0,
    "bagni": 1,
    "contratto": "vendita",
    "categoria": "casa",
    "caratteristiche": [
      "box"
    ],
    "foto": "https://via.placeholder.com/400x250/6E5C4F/ffffff?text=Immagine+non+disponibile",
    "descrizione": "A pochi passi dal centro e dal lago, in posizione comoda e ben servita, proponiamo in vendita un luminoso appartamento di 2.5 locali, completamente ri...",
    "link": "https://annuncio.miogest.com/?annuncio=+3mSh8yxosBVGpVWihYi+2xMMcJGUAVEwNR6/Od6KMw="
  }
];

    let filteredData = [...IMMOBILI_DATA];
    let allLocations = [];

    // Inizializzazione
    document.addEventListener('DOMContentLoaded', function() {
      console.log('üöÄ Inizializzo sito Netlify...');
      
      try {
        // Estrai tutte le localit√† uniche
        allLocations = [...new Set(IMMOBILI_DATA.map(item => item.comune))].sort();
        
        // Popola il dropdown delle localit√†
        const locationSelect = document.getElementById('location');
        allLocations.forEach(location => {
          const option = document.createElement('option');
          option.value = location.toLowerCase();
          option.textContent = location;
          locationSelect.appendChild(option);
        });

        // Mostra tutti gli immobili inizialmente
        renderProperties();
        updateStats();
        
        // Nascondi il loading
        document.getElementById('loading').style.display = 'none';
        document.getElementById('propertiesGrid').style.display = 'grid';
        document.getElementById('stats').style.display = 'flex';
        
        console.log(`‚úÖ Sito caricato con ${IMMOBILI_DATA.length} immobili`);
      } catch (error) {
        console.error('‚ùå Errore inizializzazione:', error);
        document.getElementById('loading').innerHTML = 'Errore nel caricamento degli immobili';
      }
    });

    // Funzione per applicare i filtri
    function applyFilters() {
      try {
        const location = document.getElementById('location').value;
        const contract = document.getElementById('contract').value;
        const type = document.getElementById('type').value;
        const priceMax = document.getElementById('priceMax').value;
        const rooms = document.getElementById('rooms').value;

        console.log('üîç Applicando filtri:', { location, contract, type, priceMax, rooms });

        filteredData = IMMOBILI_DATA.filter(property => {
          // Filtro localit√†
          if (location && property.comune.toLowerCase() !== location) {
            return false;
          }

          // Filtro contratto
          if (contract && property.contratto !== contract) {
            return false;
          }

          // Filtro tipologia
          if (type && property.categoria !== type) {
            return false;
          }

          // Filtro prezzo massimo
          if (priceMax && property.prezzo > parseInt(priceMax)) {
            return false;
          }

          // Filtro numero vani
          if (rooms && property.vani < parseFloat(rooms)) {
            return false;
          }

          return true;
        });

        console.log(`‚úÖ Trovati ${filteredData.length} immobili corrispondenti ai filtri`);
        
        renderProperties();
        updateStats();
      } catch (error) {
        console.error('‚ùå Errore applicazione filtri:', error);
      }
    }

    // Funzione per resettare i filtri
    function resetFilters() {
      try {
        document.getElementById('location').value = '';
        document.getElementById('contract').value = '';
        document.getElementById('type').value = '';
        document.getElementById('priceMax').value = '';
        document.getElementById('rooms').value = '';
        
        filteredData = [...IMMOBILI_DATA];
        renderProperties();
        updateStats();
        
        console.log('üîÑ Filtri resettati');
      } catch (error) {
        console.error('‚ùå Errore reset filtri:', error);
      }
    }

    // Funzione per renderizzare le propriet√†
    function renderProperties() {
      try {
        const grid = document.getElementById('propertiesGrid');
        const noResults = document.getElementById('noResults');

        if (filteredData.length === 0) {
          grid.style.display = 'none';
          noResults.style.display = 'block';
          return;
        }

        grid.style.display = 'grid';
        noResults.style.display = 'none';

        grid.innerHTML = filteredData.map(property => createPropertyCard(property)).join('');
      } catch (error) {
        console.error('‚ùå Errore rendering propriet√†:', error);
        document.getElementById('propertiesGrid').innerHTML = '<div>Errore nel caricamento delle propriet√†</div>';
      }
    }

    // Funzione per creare una card propriet√†
    function createPropertyCard(property) {
      try {
        const prezzoFormattato = property.prezzo > 0 
          ? `${property.valuta} ${property.prezzo.toLocaleString('it-CH')}` 
          : 'Prezzo su richiesta';

        const caratteristicheIcons = {
          vista: 'üèîÔ∏è Vista',
          giardino: 'üåø Giardino',
          terrazzo: 'üèõÔ∏è Terrazzo',
          attico: 'üè¢ Attico',
          box: 'üöó Box'
        };

        const featureTags = property.caratteristiche
          .map(feat => `<span class="feature-tag">${caratteristicheIcons[feat] || feat}</span>`)
          .join('');

        return `
          <div class="property-card">
            <div class="property-image">
              <img src="${property.foto}" alt="${property.titolo}" 
                   onerror="this.src='https://via.placeholder.com/400x250/6E5C4F/ffffff?text=Immagine+non+disponibile'">
              <div class="property-badge">${property.contratto === 'vendita' ? 'Vendita' : 'Affitto'}</div>
            </div>
            <div class="property-details">
              <div class="property-title">${property.titolo}</div>
              <div class="property-location">${property.comune}${property.regione ? ', ' + property.regione : ''}</div>
              <div class="property-price">${prezzoFormattato}</div>
              
              <div class="property-specs">
                <div class="spec-item">üìê ${property.mq} m¬≤</div>
                <div class="spec-item">üè† ${property.vani} vani</div>
                ${property.camere > 0 ? `<div class="spec-item">üõèÔ∏è ${property.camere}</div>` : ''}
                ${property.bagni > 0 ? `<div class="spec-item">üöø ${property.bagni}</div>` : ''}
              </div>
              
              ${featureTags ? `<div class="property-features">${featureTags}</div>` : ''}
              
              <div class="property-description">${property.descrizione}</div>
              
              <div class="property-buttons">
                <a class="view-button" href="${property.link}" target="_blank">
                  Vedi Dettagli
                </a>
                <a class="contact-button" href="https://porpoise-helicon-zwed.squarespace.com/proprieta#block-dd726c7158bbd7fc543f" target="_blank">
                  Contattaci
                </a>
              </div>
            </div>
          </div>
        `;
      } catch (error) {
        console.error('‚ùå Errore creazione card:', error);
        return '<div class="property-card">Errore nel caricamento immobile</div>';
      }
    }

    // Funzione per aggiornare le statistiche
    function updateStats() {
      try {
        document.getElementById('totalCount').textContent = IMMOBILI_DATA.length;
        document.getElementById('visibleCount').textContent = filteredData.length;
      } catch (error) {
        console.error('‚ùå Errore aggiornamento statistiche:', error);
      }
    }

    // Gestione errori immagini
    document.addEventListener('error', function(e) {
      if (e.target.tagName === 'IMG') {
        e.target.src = 'https://via.placeholder.com/400x250/6E5C4F/ffffff?text=Immagine+non+disponibile';
      }
    }, true);

    // Gestione errori globali
    window.addEventListener('error', function(e) {
      console.error('‚ùå Errore JavaScript:', e.error);
    });
  </script>
</body>
</html>